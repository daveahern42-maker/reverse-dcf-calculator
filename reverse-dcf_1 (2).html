<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reverse DCF Calculator - School of Investing</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);padding:20px;min-height:100vh}.container{max-width:1200px;margin:0 auto}.header{background:#fff;border-radius:16px;padding:32px;margin-bottom:24px;box-shadow:0 4px 6px rgba(0,0,0,.1)}.header h1{font-size:42px;font-weight:800;margin-bottom:16px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.header p{font-size:18px;color:#4a5568}.info-box{background:#e6fffa;border:3px solid #319795;border-radius:16px;padding:24px;margin-bottom:24px}.info-box h2{font-size:24px;font-weight:700;color:#234e52;margin-bottom:12px}.info-box p{font-size:16px;color:#234e52;line-height:1.6}.input-section{background:#fff;border-radius:16px;padding:32px;margin-bottom:24px;box-shadow:0 4px 6px rgba(0,0,0,.1)}.input-section h2{font-size:28px;font-weight:700;margin-bottom:24px;color:#2d3748}.input-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}.input-field{display:flex;flex-direction:column}.input-field label{font-size:14px;font-weight:600;color:#2d3748;margin-bottom:8px}.input-field input{padding:12px;font-size:16px;border:2px solid rgba(66,153,225,.3);border-radius:8px;outline:0}.input-field input:focus{border-color:#4299e1}.optional{color:#a0aec0;font-weight:400;font-size:12px}.calculate-btn{width:100%;padding:16px;font-size:18px;font-weight:700;color:#fff;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border:none;border-radius:12px;cursor:pointer;margin-top:32px}.calculate-btn:hover{transform:translateY(-2px)}.results-section{background:#fff;border-radius:16px;padding:32px;margin-bottom:24px;box-shadow:0 4px 6px rgba(0,0,0,.1);display:none}.results-section.show{display:block}.key-result{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:12px;padding:32px;margin-bottom:32px;text-align:center}.key-result .label{color:rgba(255,255,255,.9);font-size:18px;margin-bottom:8px}.key-result .value{color:#fff;font-size:56px;font-weight:800}.key-result .sublabel{color:rgba(255,255,255,.9);font-size:18px;margin-top:8px}.metrics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:32px}.metric-card{border-radius:12px;padding:20px;text-align:center}.metric-card .label{font-size:14px;color:#4a5568;margin-bottom:8px}.metric-card .value{font-size:28px;font-weight:700;color:#2d3748}.sanity-checks{background:#f0fff4;border:3px solid #48bb78;border-radius:12px;padding:24px;margin-bottom:24px}.sanity-checks h3{font-size:22px;font-weight:700;color:#22543d;margin-bottom:16px}.check-item{display:flex;align-items:flex-start;margin-bottom:12px;font-size:15px}.check-icon{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-right:12px;flex-shrink:0;font-size:16px;font-weight:700;color:#fff}.check-icon.pass{background:#48bb78}.check-icon.warning{background:#ed8936}.check-icon.info{background:#4299e1}.check-content{flex:1}.check-content .title{font-weight:600;color:#22543d;margin-bottom:4px}.check-content .detail{color:#38a169;font-size:14px}.mistakes{background:#fff5f5;border:3px solid #fc8181;border-radius:12px;padding:24px}.mistakes h3{font-size:22px;font-weight:700;color:#742a2a;margin-bottom:16px}.mistakes ul{margin:0;padding-left:24px;color:#742a2a;font-size:15px;line-height:1.8}.footer{background:#2d3748;border-radius:16px;padding:16px;text-align:center;color:#fff;font-weight:600}@media(max-width:768px){.header h1{font-size:32px}.key-result .value{font-size:42px}}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>Reverse DCF Calculator</h1>
<p>Discover what growth rate the market is pricing into a stock</p>
</div>

<div class="info-box">
<h2>What It Is</h2>
<p>Start from today's price and solve backward for the cash-flow growth the market is assuming. It answers: "What must happen for this price to make sense?"</p>
</div>

<div class="input-section">
<h2>Key Inputs</h2>
<div class="input-grid">
<div class="input-field">
<label>Current Price ($)</label>
<input type="number" id="currentPrice" placeholder="150.00" step="0.01">
</div>
<div class="input-field">
<label>Shares Outstanding (M)</label>
<input type="number" id="sharesOutstanding" placeholder="1000" step="0.01">
</div>
<div class="input-field">
<label>Base-Year FCF ($M)</label>
<input type="number" id="baseFCF" placeholder="5000" step="0.01">
</div>
<div class="input-field">
<label>Discount Rate (%)</label>
<input type="number" id="discountRate" placeholder="10" step="0.1">
</div>
<div class="input-field">
<label>Forecast Horizon (years)</label>
<input type="number" id="horizon" value="10" step="1">
</div>
<div class="input-field">
<label>Terminal Growth (%)</label>
<input type="number" id="terminalGrowth" placeholder="2.5" step="0.1">
</div>
<div class="input-field">
<label>Net Debt ($M) <span class="optional">(optional)</span></label>
<input type="number" id="netDebt" placeholder="0" step="0.01">
</div>
<div class="input-field">
<label>Expected Dilution (%) <span class="optional">(optional)</span></label>
<input type="number" id="dilution" placeholder="0" step="0.1">
</div>
</div>
<button class="calculate-btn" onclick="calc()">Calculate Implied Growth Rate</button>
</div>

<div class="results-section" id="results">
<div class="key-result">
<div class="label">Market is Pricing In</div>
<div class="value" id="growth">--</div>
<div class="sublabel">Annual FCF Growth Rate</div>
</div>

<div class="metrics-grid">
<div class="metric-card" style="background:rgba(66,153,225,.15);border:2px solid #4299e1">
<div class="label">Market Cap</div>
<div class="value" id="mcap">--</div>
</div>
<div class="metric-card" style="background:rgba(72,187,120,.15);border:2px solid #48bb78">
<div class="label">Enterprise Value</div>
<div class="value" id="ev">--</div>
</div>
<div class="metric-card" style="background:rgba(237,137,54,.15);border:2px solid #ed8936">
<div class="label">Terminal Value</div>
<div class="value" id="tv">--</div>
</div>
</div>

<div class="sanity-checks">
<h3>Sanity Checks</h3>
<div id="checks"></div>
</div>

<div class="mistakes">
<h3>Common Mistakes to Avoid</h3>
<ul>
<li><strong>Mixing FCFF with market cap</strong> or FCFE with EV</li>
<li><strong>Base year includes one-off items</strong></li>
<li><strong>Ignoring dilution/stock-based comp</strong></li>
<li><strong>Over-optimistic terminal growth</strong></li>
</ul>
</div>
</div>

<div class="footer"><strong>School of Investing</strong> • Dave Ahern</div>
</div>

<script>
function calc(){
const p=parseFloat(document.getElementById('currentPrice').value);
const s=parseFloat(document.getElementById('sharesOutstanding').value);
const f=parseFloat(document.getElementById('baseFCF').value);
const r=parseFloat(document.getElementById('discountRate').value)/100;
const n=parseInt(document.getElementById('horizon').value);
const g=parseFloat(document.getElementById('terminalGrowth').value)/100;
const d=parseFloat(document.getElementById('netDebt').value)||0;
if(!p||!s||!f||!r||!n||isNaN(g)){alert('Please fill in all required fields');return}
const mc=p*s;
const ev=mc+d;
let ig=0;
let be=Infinity;
for(let tg=-0.05;tg<=0.50;tg+=0.001){
let pv=0;
for(let y=1;y<=n;y++){
const yf=f*Math.pow(1+tg,y);
pv+=yf/Math.pow(1+r,y);
}
const tf=f*Math.pow(1+tg,n)*(1+g);
const tvl=tf/(r-g);
const pvt=tvl/Math.pow(1+r,n);
const tot=pv+pvt;
const err=Math.abs(tot-ev);
if(err<be){
be=err;
ig=tg;
}
}
const tf=f*Math.pow(1+ig,n)*(1+g);
const tvl=tf/(r-g);
document.getElementById('growth').textContent=(ig*100).toFixed(1)+'%';
document.getElementById('mcap').textContent='$'+(mc/1000).toFixed(1)+'B';
document.getElementById('ev').textContent='$'+(ev/1000).toFixed(1)+'B';
document.getElementById('tv').textContent='$'+(tvl/1000).toFixed(1)+'B';

const igPct=ig*100;
const gPct=g*100;
const chk=[];

// Check 1: Growth vs GDP - now shows warning if high, pass if reasonable
if(igPct<=4){
chk.push({
icon:'pass',
title:'Conservative Growth Expectations',
detail:`Implied ${igPct.toFixed(1)}% is at or below long-run GDP (4%). Market expects modest growth.`
});
}else if(igPct<=15){
chk.push({
icon:'info',
title:'Moderate Growth Expectations',
detail:`Implied ${igPct.toFixed(1)}% is above GDP but reasonable. Verify company can sustain this.`
});
}else{
chk.push({
icon:'warning',
title:'Aggressive Growth Expectations',
detail:`Implied ${igPct.toFixed(1)}% is well above long-run GDP (4%). Market is pricing in strong growth - verify this is achievable.`
});
}

// Check 2: Growth vs Terminal
if(igPct>gPct){
chk.push({
icon:'pass',
title:'Growth Exceeds Terminal Rate',
detail:`${igPct.toFixed(1)}% vs ${gPct.toFixed(1)}% terminal - mathematically consistent`
});
}else{
chk.push({
icon:'warning',
title:'Growth Below Terminal Rate',
detail:`${igPct.toFixed(1)}% vs ${gPct.toFixed(1)}% terminal - this suggests declining growth, which may not be realistic`
});
}

// Check 3: Reasonable range
if(ig>=-0.05&&ig<=0.40){
chk.push({
icon:'pass',
title:'Growth Rate is Reasonable',
detail:'Within -5% to 40% range - falls within typical business growth bounds'
});
}else{
chk.push({
icon:'warning',
title:'Growth Rate is Extreme',
detail:'Outside -5% to 40% range - verify your inputs and assumptions'
});
}

document.getElementById('checks').innerHTML=chk.map(c=>`
<div class="check-item">
<div class="check-icon ${c.icon}">${c.icon==='pass'?'✓':c.icon==='warning'?'⚠':'ℹ'}</div>
<div class="check-content">
<div class="title">${c.title}</div>
<div class="detail">${c.detail}</div>
</div>
</div>
`).join('');

document.getElementById('results').classList.add('show');
document.getElementById('results').scrollIntoView({behavior:'smooth'});
}
</script>
</body>
</html>
